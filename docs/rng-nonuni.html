<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 非均匀随机数生成 | 统计计算</title>
  <meta name="description" content="这是使用bookdwon编写的书籍。" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 非均匀随机数生成 | 统计计算" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="这是使用bookdwon编写的书籍。" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 非均匀随机数生成 | 统计计算" />
  
  <meta name="twitter:description" content="这是使用bookdwon编写的书籍。" />
  

<meta name="author" content="Huang" />


<meta name="date" content="2021-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rng-uniform.html"/>
<link rel="next" href="rng-multi.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">统计计算</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>背景</a></li>
<li class="chapter" data-level="1" data-path="intro-error.html"><a href="intro-error.html"><i class="fa fa-check"></i><b>1</b> 误差</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro-error.html"><a href="intro-error.html#习题"><i class="fa fa-check"></i><b>1.1</b> 习题</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-summary.html"><a href="intro-summary.html"><i class="fa fa-check"></i><b>2</b> 概括统计量</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-summary.html"><a href="intro-summary.html#习题-1"><i class="fa fa-check"></i><b>2.1</b> 习题</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro-graph.html"><a href="intro-graph.html"><i class="fa fa-check"></i><b>3</b> 统计图形</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intro-graph.html"><a href="intro-graph.html#习题-2"><i class="fa fa-check"></i><b>3.1</b> 习题</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rng-uniform.html"><a href="rng-uniform.html"><i class="fa fa-check"></i><b>4</b> 均匀分布随机数生成</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rng-uniform.html"><a href="rng-uniform.html#习题-3"><i class="fa fa-check"></i><b>4.1</b> 习题</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rng-nonuni.html"><a href="rng-nonuni.html"><i class="fa fa-check"></i><b>5</b> 非均匀随机数生成</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rng-nonuni.html"><a href="rng-nonuni.html#笔记"><i class="fa fa-check"></i><b>5.1</b> 笔记</a></li>
<li class="chapter" data-level="5.2" data-path="rng-nonuni.html"><a href="rng-nonuni.html#习题-4"><i class="fa fa-check"></i><b>5.2</b> 习题</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rng-multi.html"><a href="rng-multi.html"><i class="fa fa-check"></i><b>6</b> 随机向量和随机过程的随机数</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rng-multi.html"><a href="rng-multi.html#笔记-1"><i class="fa fa-check"></i><b>6.1</b> 笔记</a></li>
<li class="chapter" data-level="6.2" data-path="rng-multi.html"><a href="rng-multi.html#习题-5"><i class="fa fa-check"></i><b>6.2</b> 习题</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计计算</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rng-nonuni" class="section level1" number="5">
<h1><span class="header-section-number">5</span> 非均匀随机数生成</h1>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="rng-nonuni.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="笔记" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 笔记</h2>
<div id="用逆变换法生成离散型随机数" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> 用逆变换法生成离散型随机数</h3>
<p>定理6.2非常重要，主要的思路就是明确概率空间点集，然后求在点集上各点的分布函数值（累加），再生成[0,1]均匀分布随机数，找到对应分布函数值大于等于它并最与它接近的点值，就是服从给定分布的一个随机数。书本上一开始定义是对应分布函数值大于等于它并最与它接近的点值，后来代码又变成了对应分布函数值小于于等于它并最与它接近的点值，有点莫名其妙。</p>
</div>
<div id="r中的离散分布函数" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> R中的离散分布函数</h3>
<p>看一下对于离散分布，R中的分布函数定义是<span class="math inline">\(P\{X\le x\}\)</span>还是<span class="math inline">\(P\{X&lt; x\}\)</span>。考虑<span class="math inline">\(b(3,0.5)\)</span>，</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="rng-nonuni.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)</span>
<span id="cb39-2"><a href="rng-nonuni.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<p>也即是<span class="math inline">\(F(1)=0.5\)</span>.由于<span class="math inline">\(P\{X\le 1\}=P\{X= 0,1\}=0.5\)</span>，所以在R中分布函数的定义为<span class="math inline">\(F(x)=P\{X\le x\}\)</span>.</p>
</div>
</div>
<div id="习题-4" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 习题</h2>
<div id="习题1-4" class="section level3 unnumbered">
<h3>习题1</h3>
<p><strong>解：</strong></p>
<p>先定义一个函数：</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="rng-nonuni.html#cb40-1" aria-hidden="true" tabindex="-1"></a>myfun <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb40-2"><a href="rng-nonuni.html#cb40-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb40-3"><a href="rng-nonuni.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>,n)</span>
<span id="cb40-4"><a href="rng-nonuni.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb40-5"><a href="rng-nonuni.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> i<span class="sc">&lt;</span><span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb40-6"><a href="rng-nonuni.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  x[j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb40-7"><a href="rng-nonuni.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">samples =</span> x, <span class="at">p =</span> <span class="fu">mean</span>(j))</span>
<span id="cb40-8"><a href="rng-nonuni.html#cb40-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="rng-nonuni.html#cb41-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>)</span>
<span id="cb41-2"><a href="rng-nonuni.html#cb41-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> n <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="rng-nonuni.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(myfun) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="rng-nonuni.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dbl</span>(<span class="sc">~</span>.<span class="sc">$</span>p)</span>
<span id="cb41-5"><a href="rng-nonuni.html#cb41-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">n=</span>n,<span class="at">p=</span>p),<span class="at">align =</span> <span class="st">&quot;cc&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">n</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">100</td>
<td align="center">0.3300</td>
</tr>
<tr class="even">
<td align="center">1000</td>
<td align="center">0.3230</td>
</tr>
<tr class="odd">
<td align="center">10000</td>
<td align="center">0.3377</td>
</tr>
</tbody>
</table>
<p>第4问不太看得懂，先占坑。</p>
</div>
<div id="习题2-4" class="section level3 unnumbered">
<h3>习题2</h3>
<p><strong>解：</strong></p>
<p>仿照例6.2：</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="rng-nonuni.html#cb42-1" aria-hidden="true" tabindex="-1"></a>rng.pk <span class="ot">&lt;-</span> <span class="cf">function</span>(n, pk)</span>
<span id="cb42-2"><a href="rng-nonuni.html#cb42-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-3"><a href="rng-nonuni.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(pk)<span class="sc">!=</span><span class="dv">1</span>) <span class="fu">stop</span>(<span class="st">&quot;the sum of pk must be 1&quot;</span>)</span>
<span id="cb42-4"><a href="rng-nonuni.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(pk)</span>
<span id="cb42-5"><a href="rng-nonuni.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  Fvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(pk[<span class="sc">-</span>m]))  </span>
<span id="cb42-6"><a href="rng-nonuni.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb42-7"><a href="rng-nonuni.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>,n)</span>
<span id="cb42-8"><a href="rng-nonuni.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb42-9"><a href="rng-nonuni.html#cb42-9" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">which</span>(Fvs <span class="sc">&lt;=</span> p[[i]]))</span>
<span id="cb42-10"><a href="rng-nonuni.html#cb42-10" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> j</span>
<span id="cb42-11"><a href="rng-nonuni.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-12"><a href="rng-nonuni.html#cb42-12" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb42-13"><a href="rng-nonuni.html#cb42-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>测试：</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="rng-nonuni.html#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.pk</span>(<span class="dv">1000</span>,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.6</span>))</span>
<span id="cb43-2"><a href="rng-nonuni.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(x))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb43-3"><a href="rng-nonuni.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x</span></span>
<span id="cb43-4"><a href="rng-nonuni.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2    3 </span></span>
<span id="cb43-5"><a href="rng-nonuni.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10.3 31.4 58.3</span></span></code></pre></div>
</div>
<div id="习题3-3" class="section level3 unnumbered">
<h3>习题3</h3>
<p><strong>解：</strong></p>
<p>先进行统计模拟。</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="rng-nonuni.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># n次实验</span></span>
<span id="cb44-2"><a href="rng-nonuni.html#cb44-2" aria-hidden="true" tabindex="-1"></a>draw.card <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb44-3"><a href="rng-nonuni.html#cb44-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb44-4"><a href="rng-nonuni.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>,n)</span>
<span id="cb44-5"><a href="rng-nonuni.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb44-6"><a href="rng-nonuni.html#cb44-6" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">54</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="co"># 1次实验结果</span></span>
<span id="cb44-7"><a href="rng-nonuni.html#cb44-7" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> <span class="fu">sum</span>(s<span class="sc">==</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">54</span>))</span>
<span id="cb44-8"><a href="rng-nonuni.html#cb44-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-9"><a href="rng-nonuni.html#cb44-9" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb44-10"><a href="rng-nonuni.html#cb44-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-11"><a href="rng-nonuni.html#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="rng-nonuni.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 取n=100000</span></span>
<span id="cb44-13"><a href="rng-nonuni.html#cb44-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb44-14"><a href="rng-nonuni.html#cb44-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">draw.card</span>(n)</span>
<span id="cb44-15"><a href="rng-nonuni.html#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb44-16"><a href="rng-nonuni.html#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 36806</span></span>
<span id="cb44-17"><a href="rng-nonuni.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb44-18"><a href="rng-nonuni.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.99936</span></span>
<span id="cb44-19"><a href="rng-nonuni.html#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb44-20"><a href="rng-nonuni.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9978296</span></span></code></pre></div>
<p>均值跟方差都是1.</p>
<p>再进行理论推导。</p>
<p>容易知道，<span class="math inline">\(T\in\{1,2,\cdots,54\}\)</span>为离散随机变量，需要用到<a href="https://baike.baidu.com/item/%E5%85%A8%E9%94%99%E4%BD%8D%E6%8E%92%E5%88%97/6806416">全错位排列</a>，不妨设<span class="math inline">\(D_n\)</span>为总数为<span class="math inline">\(n\)</span>的全错位排列数，有递推公式<span class="math inline">\(D_n=(n-1)(D_{n-1}+D_{n-2})\)</span>，不妨补充定义<span class="math inline">\(D_0=1\)</span>，则
<span class="math display">\[
P\{T_n=0\} = C_n^0\cdot D_n/n!\\
P\{T_n=1\} = C_n^1\cdot D_{n-1}/n!\\
\cdots \\
P\{T_n=k\} = C_n^k\cdot D_{n-k}/n!\\
\cdots \\
P\{T_n=n-1\} = C_n^{n-1}\cdot D_{1}/n!\\
P\{T_n=n\} = C_n^{n}\cdot D_{0}/n!\\
\]</span></p>
<p>题中当<span class="math inline">\(n=54\)</span>，还是得借助计算机：</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="rng-nonuni.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 先定义函数求[D_0,...,D_n]</span></span>
<span id="cb45-2"><a href="rng-nonuni.html#cb45-2" aria-hidden="true" tabindex="-1"></a>D.n <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb45-3"><a href="rng-nonuni.html#cb45-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-4"><a href="rng-nonuni.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>, n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb45-5"><a href="rng-nonuni.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(D)) {</span>
<span id="cb45-6"><a href="rng-nonuni.html#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) D[[i]] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># D_0</span></span>
<span id="cb45-7"><a href="rng-nonuni.html#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">2</span>) D[[i]] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># D_1</span></span>
<span id="cb45-8"><a href="rng-nonuni.html#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb45-9"><a href="rng-nonuni.html#cb45-9" aria-hidden="true" tabindex="-1"></a>      D[[i]] <span class="ot">&lt;-</span> (i<span class="dv">-2</span>)<span class="sc">*</span>(D[[i<span class="dv">-1</span>]]<span class="sc">+</span>D[[i<span class="dv">-2</span>]]) <span class="co"># D_{i-1}</span></span>
<span id="cb45-10"><a href="rng-nonuni.html#cb45-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-11"><a href="rng-nonuni.html#cb45-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-12"><a href="rng-nonuni.html#cb45-12" aria-hidden="true" tabindex="-1"></a>  D</span>
<span id="cb45-13"><a href="rng-nonuni.html#cb45-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-14"><a href="rng-nonuni.html#cb45-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">54</span></span>
<span id="cb45-15"><a href="rng-nonuni.html#cb45-15" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> n<span class="sc">:</span><span class="dv">0</span></span>
<span id="cb45-16"><a href="rng-nonuni.html#cb45-16" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">D.n</span>(n)<span class="sc">*</span><span class="fu">choose</span>(n,i)<span class="sc">/</span><span class="fu">factorial</span>(n)  <span class="co"># P{T=n,...,0}</span></span>
<span id="cb45-17"><a href="rng-nonuni.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 求均值</span></span>
<span id="cb45-18"><a href="rng-nonuni.html#cb45-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(i<span class="sc">*</span>P)</span>
<span id="cb45-19"><a href="rng-nonuni.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 求方差</span></span>
<span id="cb45-20"><a href="rng-nonuni.html#cb45-20" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">sum</span>((i<span class="sc">-</span>m)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>P)</span>
<span id="cb45-21"><a href="rng-nonuni.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;均值=&quot;</span>,m,<span class="st">&quot;,方差=&quot;</span>,v,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb45-22"><a href="rng-nonuni.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;均值=0.999999999999983,方差=0.999999999999983&quot;</span></span></code></pre></div>
<p>考虑到误差，可以认为理论值的均值跟方差都是1.</p>
</div>
<div id="习题4-3" class="section level3 unnumbered">
<h3>习题4</h3>
<p><strong>解：</strong></p>
<p>先定义投掷色子的函数：</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="rng-nonuni.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 返回n次实验的结果</span></span>
<span id="cb46-2"><a href="rng-nonuni.html#cb46-2" aria-hidden="true" tabindex="-1"></a>roll.dice <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb46-3"><a href="rng-nonuni.html#cb46-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-4"><a href="rng-nonuni.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb46-5"><a href="rng-nonuni.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb46-6"><a href="rng-nonuni.html#cb46-6" aria-hidden="true" tabindex="-1"></a>    l <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">11</span>)</span>
<span id="cb46-7"><a href="rng-nonuni.html#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (<span class="fu">min</span>(l)<span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb46-8"><a href="rng-nonuni.html#cb46-8" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sample.int</span>(<span class="dv">6</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">replace=</span><span class="cn">TRUE</span>))  <span class="co"># 投掷两次色子</span></span>
<span id="cb46-9"><a href="rng-nonuni.html#cb46-9" aria-hidden="true" tabindex="-1"></a>      l[[i<span class="dv">-1</span>]] <span class="ot">&lt;-</span> l[[i<span class="dv">-1</span>]]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-10"><a href="rng-nonuni.html#cb46-10" aria-hidden="true" tabindex="-1"></a>      x[[j]] <span class="ot">&lt;-</span> x[[j]]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-11"><a href="rng-nonuni.html#cb46-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-12"><a href="rng-nonuni.html#cb46-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-13"><a href="rng-nonuni.html#cb46-13" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb46-14"><a href="rng-nonuni.html#cb46-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-15"><a href="rng-nonuni.html#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="rng-nonuni.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 开始模拟</span></span>
<span id="cb46-17"><a href="rng-nonuni.html#cb46-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb46-18"><a href="rng-nonuni.html#cb46-18" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">roll.dice</span>(n)</span>
<span id="cb46-19"><a href="rng-nonuni.html#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb46-20"><a href="rng-nonuni.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 61.1509</span></span>
<span id="cb46-21"><a href="rng-nonuni.html#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x)</span>
<span id="cb46-22"><a href="rng-nonuni.html#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1283.881</span></span></code></pre></div>
</div>
<div id="习题7" class="section level3 unnumbered">
<h3>习题7</h3>
<p><strong>解：</strong></p>
<p>这里需要注意的是，负二项分布的定义主要有两种，一种如题所示，另一种是独立重复试验中第<span class="math inline">\(r\)</span>次成功所经历的<strong>失败</strong>次数（R函数的定义）。此外，关于几何分布也一样，R函数的定义是描述了独立重复试验中首次成功所经历的<strong>失败</strong>次数。</p>
<p>1、考虑几何分布跟负二项分布的关系。几何分布描述了独立重复试验中首次成功所需的试验次数，而负二项分布描述了独立重复试验中第<span class="math inline">\(r\)</span>次成功所需的试验次数，则可以产生<span class="math inline">\(r\)</span>个几何分布随机数，求和就是一个负二项分布随机数：</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="rng-nonuni.html#cb47-1" aria-hidden="true" tabindex="-1"></a>rng.nbinom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, r)</span>
<span id="cb47-2"><a href="rng-nonuni.html#cb47-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-3"><a href="rng-nonuni.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rgeom</span>(n<span class="sc">*</span>r,p)<span class="sc">+</span><span class="dv">1</span>,n,r)  <span class="co"># n行r列</span></span>
<span id="cb47-4"><a href="rng-nonuni.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">apply</span>(y, <span class="dv">1</span>, sum)</span>
<span id="cb47-5"><a href="rng-nonuni.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb47-6"><a href="rng-nonuni.html#cb47-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-7"><a href="rng-nonuni.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="rng-nonuni.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb47-9"><a href="rng-nonuni.html#cb47-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb47-10"><a href="rng-nonuni.html#cb47-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb47-11"><a href="rng-nonuni.html#cb47-11" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb47-12"><a href="rng-nonuni.html#cb47-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.nbinom.1</span>(n,p,r)</span>
<span id="cb47-13"><a href="rng-nonuni.html#cb47-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>  <span class="co"># 失败次数</span></span>
<span id="cb47-14"><a href="rng-nonuni.html#cb47-14" aria-hidden="true" tabindex="-1"></a>yy <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(y,<span class="at">size =</span> r,<span class="at">prob =</span> p)</span>
<span id="cb47-15"><a href="rng-nonuni.html#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks=</span><span class="dv">15</span>,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb47-16"><a href="rng-nonuni.html#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y<span class="sc">+</span>r,yy,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-54-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>2、直接利用负二项分布的概率分布，由于负二项分布：
<span class="math display">\[
P\{x=k\} = \binom{k-1}{r-1}p^r(1-p)^{k-r},\quad k=r,r+1,\cdots
\]</span></p>
<p>考虑分布函数：
<span class="math display">\[
\begin{align}
F(k) &amp;= P\{x\le k\}= P\{\text{在前k次实验至少成功r次}\}\\
&amp;= 1-P\{\text{在前k次实验成功小于r次}\}\\
&amp;= 1-\sum_{i=0}^{r-1}P\{\text{在前k次实验成功i次}\}\\
&amp;= 1-\sum_{i=0}^{r-1}\binom{k}{i}p^i(1-p)^{k-i}\\
&amp;:= 1-BS(k,r,p) \quad k=r,r+1,\cdots
\end{align}
\]</span></p>
<p>所以生成随机数<span class="math inline">\(X\)</span>的方法为当且仅当<span class="math inline">\(F(k-1)&lt; U\le F(k)\)</span>取<span class="math inline">\(X=k\)</span>。这又等价于
<span class="math display">\[
BS(k,r,p)\le U &lt;BS(k-1,r,p)
\]</span></p>
<p>取
<span class="math display">\[
\begin{align}
X &amp;= \min\{k:BS(k,r,p)\le U\} 
\end{align}
\]</span></p>
<p>定义函数：</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="rng-nonuni.html#cb48-1" aria-hidden="true" tabindex="-1"></a>rng.nbinom<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, r)</span>
<span id="cb48-2"><a href="rng-nonuni.html#cb48-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb48-3"><a href="rng-nonuni.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 先定义BS函数</span></span>
<span id="cb48-4"><a href="rng-nonuni.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  BS <span class="ot">&lt;-</span> <span class="cf">function</span>(k.,r.,p.)</span>
<span id="cb48-5"><a href="rng-nonuni.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb48-6"><a href="rng-nonuni.html#cb48-6" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(r.<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb48-7"><a href="rng-nonuni.html#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">choose</span>(k.,i)<span class="sc">*</span>p.<span class="sc">^</span>i<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.)<span class="sc">^</span>(k.<span class="sc">-</span>i))</span>
<span id="cb48-8"><a href="rng-nonuni.html#cb48-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-9"><a href="rng-nonuni.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-10"><a href="rng-nonuni.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>, n)</span>
<span id="cb48-11"><a href="rng-nonuni.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb48-12"><a href="rng-nonuni.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb48-13"><a href="rng-nonuni.html#cb48-13" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> r  <span class="co"># 初值</span></span>
<span id="cb48-14"><a href="rng-nonuni.html#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (<span class="fu">BS</span>(k,r,p)<span class="sc">&gt;</span>u[[j]]) {</span>
<span id="cb48-15"><a href="rng-nonuni.html#cb48-15" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb48-16"><a href="rng-nonuni.html#cb48-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-17"><a href="rng-nonuni.html#cb48-17" aria-hidden="true" tabindex="-1"></a>    x[[j]] <span class="ot">&lt;-</span> k</span>
<span id="cb48-18"><a href="rng-nonuni.html#cb48-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-19"><a href="rng-nonuni.html#cb48-19" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb48-20"><a href="rng-nonuni.html#cb48-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-21"><a href="rng-nonuni.html#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="rng-nonuni.html#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb48-23"><a href="rng-nonuni.html#cb48-23" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-24"><a href="rng-nonuni.html#cb48-24" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb48-25"><a href="rng-nonuni.html#cb48-25" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb48-26"><a href="rng-nonuni.html#cb48-26" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.nbinom.2</span>(n,p,r)</span>
<span id="cb48-27"><a href="rng-nonuni.html#cb48-27" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span>  <span class="co"># 失败次数</span></span>
<span id="cb48-28"><a href="rng-nonuni.html#cb48-28" aria-hidden="true" tabindex="-1"></a>yy <span class="ot">&lt;-</span> <span class="fu">dnbinom</span>(y,<span class="at">size =</span> r,<span class="at">prob =</span> p)</span>
<span id="cb48-29"><a href="rng-nonuni.html#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks=</span><span class="dv">15</span>,<span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb48-30"><a href="rng-nonuni.html#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y<span class="sc">+</span>r,yy,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-55-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="习题8" class="section level3 unnumbered">
<h3>习题8</h3>
<p><strong>解：</strong></p>
<p>1、先求分布函数的反函数：
<span class="math display">\[
F^{-1}(u) = u^n
\]</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="rng-nonuni.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m:随机数序列长度</span></span>
<span id="cb49-2"><a href="rng-nonuni.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># n:参数n</span></span>
<span id="cb49-3"><a href="rng-nonuni.html#cb49-3" aria-hidden="true" tabindex="-1"></a>rng.beta<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n)</span>
<span id="cb49-4"><a href="rng-nonuni.html#cb49-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb49-5"><a href="rng-nonuni.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb49-6"><a href="rng-nonuni.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> u<span class="sc">^</span>n</span>
<span id="cb49-7"><a href="rng-nonuni.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb49-8"><a href="rng-nonuni.html#cb49-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-9"><a href="rng-nonuni.html#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="rng-nonuni.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb49-11"><a href="rng-nonuni.html#cb49-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb49-12"><a href="rng-nonuni.html#cb49-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb49-13"><a href="rng-nonuni.html#cb49-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb49-14"><a href="rng-nonuni.html#cb49-14" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-15"><a href="rng-nonuni.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb49-16"><a href="rng-nonuni.html#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n)) {</span>
<span id="cb49-17"><a href="rng-nonuni.html#cb49-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rng.beta.1</span>(m, n[[i]])</span>
<span id="cb49-18"><a href="rng-nonuni.html#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;n=&quot;</span>,n[[i]],<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb49-19"><a href="rng-nonuni.html#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,<span class="fu">dbeta</span>(y,<span class="dv">1</span><span class="sc">/</span>n[[i]],<span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb49-20"><a href="rng-nonuni.html#cb49-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-21"><a href="rng-nonuni.html#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>2、先求分布函数的反函数：</p>
<p><span class="math display">\[
F^{-1}(u) = u^{1/n}
\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="rng-nonuni.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m:随机数序列长度</span></span>
<span id="cb50-2"><a href="rng-nonuni.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># n:参数n</span></span>
<span id="cb50-3"><a href="rng-nonuni.html#cb50-3" aria-hidden="true" tabindex="-1"></a>rng.beta<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n)</span>
<span id="cb50-4"><a href="rng-nonuni.html#cb50-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-5"><a href="rng-nonuni.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb50-6"><a href="rng-nonuni.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> u<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span>n}</span>
<span id="cb50-7"><a href="rng-nonuni.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb50-8"><a href="rng-nonuni.html#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-9"><a href="rng-nonuni.html#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="rng-nonuni.html#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb50-11"><a href="rng-nonuni.html#cb50-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb50-12"><a href="rng-nonuni.html#cb50-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb50-13"><a href="rng-nonuni.html#cb50-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb50-14"><a href="rng-nonuni.html#cb50-14" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-15"><a href="rng-nonuni.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb50-16"><a href="rng-nonuni.html#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n)) {</span>
<span id="cb50-17"><a href="rng-nonuni.html#cb50-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rng.beta.2</span>(m, n[[i]])</span>
<span id="cb50-18"><a href="rng-nonuni.html#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;n=&quot;</span>,n[[i]],<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb50-19"><a href="rng-nonuni.html#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,<span class="fu">dbeta</span>(y,n[[i]],<span class="dv">1</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb50-20"><a href="rng-nonuni.html#cb50-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-21"><a href="rng-nonuni.html#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-57-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>3、先求分布函数的反函数：
<span class="math display">\[
F^{-1}(u) = \sin(\frac{\pi u}{2})
\]</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="rng-nonuni.html#cb51-1" aria-hidden="true" tabindex="-1"></a>rng.sin <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb51-2"><a href="rng-nonuni.html#cb51-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb51-3"><a href="rng-nonuni.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb51-4"><a href="rng-nonuni.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sin</span>(pi<span class="sc">*</span>u<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb51-5"><a href="rng-nonuni.html#cb51-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-6"><a href="rng-nonuni.html#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="rng-nonuni.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb51-8"><a href="rng-nonuni.html#cb51-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb51-9"><a href="rng-nonuni.html#cb51-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.sin</span>(n)</span>
<span id="cb51-10"><a href="rng-nonuni.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-11"><a href="rng-nonuni.html#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">2</span><span class="sc">/</span>(pi<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>4、先求分布函数的反函数：
<span class="math display">\[
F^{-1}(u) = \tan(\pi u)
\]</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="rng-nonuni.html#cb52-1" aria-hidden="true" tabindex="-1"></a>rng.tan <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb52-2"><a href="rng-nonuni.html#cb52-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb52-3"><a href="rng-nonuni.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb52-4"><a href="rng-nonuni.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tan</span>(pi<span class="sc">*</span>u)</span>
<span id="cb52-5"><a href="rng-nonuni.html#cb52-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-6"><a href="rng-nonuni.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="rng-nonuni.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb52-8"><a href="rng-nonuni.html#cb52-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb52-9"><a href="rng-nonuni.html#cb52-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.tan</span>(n)</span>
<span id="cb52-10"><a href="rng-nonuni.html#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">breaks =</span> <span class="dv">1000</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>))</span>
<span id="cb52-11"><a href="rng-nonuni.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="sc">-</span><span class="dv">50</span>,<span class="dv">50</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-59-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>5、先求分布函数的反函数：
<span class="math display">\[
F^{-1}(u) = \arcsin(u)
\]</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="rng-nonuni.html#cb53-1" aria-hidden="true" tabindex="-1"></a>rng.asin <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb53-2"><a href="rng-nonuni.html#cb53-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-3"><a href="rng-nonuni.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb53-4"><a href="rng-nonuni.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">asin</span>(u)</span>
<span id="cb53-5"><a href="rng-nonuni.html#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-6"><a href="rng-nonuni.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="rng-nonuni.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb53-8"><a href="rng-nonuni.html#cb53-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-9"><a href="rng-nonuni.html#cb53-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.asin</span>(n)</span>
<span id="cb53-10"><a href="rng-nonuni.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-11"><a href="rng-nonuni.html#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">cos</span>(x),<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>6、先求分布函数的反函数：
<span class="math display">\[
F^{-1}(u) = [-\eta\log(1-u)]^{1/\alpha}
\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="rng-nonuni.html#cb54-1" aria-hidden="true" tabindex="-1"></a>rng.weibull <span class="ot">&lt;-</span> <span class="cf">function</span>(n, alpha, eta)</span>
<span id="cb54-2"><a href="rng-nonuni.html#cb54-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-3"><a href="rng-nonuni.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb54-4"><a href="rng-nonuni.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span>eta<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>alpha)</span>
<span id="cb54-5"><a href="rng-nonuni.html#cb54-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-6"><a href="rng-nonuni.html#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="rng-nonuni.html#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb54-8"><a href="rng-nonuni.html#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="rng-nonuni.html#cb54-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>)</span>
<span id="cb54-10"><a href="rng-nonuni.html#cb54-10" aria-hidden="true" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>)</span>
<span id="cb54-11"><a href="rng-nonuni.html#cb54-11" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-12"><a href="rng-nonuni.html#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb54-13"><a href="rng-nonuni.html#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 固定alpha=1</span></span>
<span id="cb54-14"><a href="rng-nonuni.html#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(eta)) {</span>
<span id="cb54-15"><a href="rng-nonuni.html#cb54-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rng.weibull</span>(n, alpha[[<span class="dv">2</span>]], eta[[i]])</span>
<span id="cb54-16"><a href="rng-nonuni.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;alpha=1,eta=&quot;</span>,eta[[i]],<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb54-17"><a href="rng-nonuni.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(alpha[[<span class="dv">2</span>]]<span class="sc">/</span>eta[[i]]<span class="sc">*</span>x<span class="sc">^</span>(alpha[[<span class="dv">2</span>]]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span>alpha[[<span class="dv">2</span>]]<span class="sc">/</span>eta[[i]]),<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb54-18"><a href="rng-nonuni.html#cb54-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-19"><a href="rng-nonuni.html#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="rng-nonuni.html#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 固定eta=1</span></span>
<span id="cb54-21"><a href="rng-nonuni.html#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(alpha)) {</span>
<span id="cb54-22"><a href="rng-nonuni.html#cb54-22" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rng.weibull</span>(n, alpha[[i]], eta[[<span class="dv">2</span>]])</span>
<span id="cb54-23"><a href="rng-nonuni.html#cb54-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;eta=1,alpha=&quot;</span>,alpha[[i]],<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb54-24"><a href="rng-nonuni.html#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(alpha[[i]]<span class="sc">/</span>eta[[<span class="dv">2</span>]]<span class="sc">*</span>x<span class="sc">^</span>(alpha[[i]]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span>alpha[[i]]<span class="sc">/</span>eta[[<span class="dv">2</span>]]),<span class="dv">0</span>,<span class="dv">20</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb54-25"><a href="rng-nonuni.html#cb54-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-26"><a href="rng-nonuni.html#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-61-1.png" width="80%" style="display: block; margin: auto;" /><img src="statcomp_files/figure-html/unnamed-chunk-61-2.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="习题9" class="section level3 unnumbered">
<h3>习题9</h3>
<p><strong>解：</strong></p>
<p>思路是循环批量生成<span class="math inline">\(\exp(1)\)</span>样本，再判断是否符合要求。关于每次生成样本数的选择，为了期望能循环一次就能得到<span class="math inline">\(n\)</span>个符合要求的样本，可以利用<span class="math inline">\(F(0.05)\)</span>作为批量生成样本中符合要求样本的概率，批量生成样本数可以大致利用<span class="math inline">\(n/F(0.05)\)</span>。</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="rng-nonuni.html#cb55-1" aria-hidden="true" tabindex="-1"></a>rng.exp <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">x0=</span><span class="fl">0.05</span>)</span>
<span id="cb55-2"><a href="rng-nonuni.html#cb55-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-3"><a href="rng-nonuni.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, n)</span>
<span id="cb55-4"><a href="rng-nonuni.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 记录符合要求的样本数</span></span>
<span id="cb55-5"><a href="rng-nonuni.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb55-6"><a href="rng-nonuni.html#cb55-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="fu">floor</span>(n<span class="sc">/</span><span class="fu">pexp</span>(x0)))  <span class="co"># 分块生成样本，而不是单个生成</span></span>
<span id="cb55-7"><a href="rng-nonuni.html#cb55-7" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> (y<span class="sc">&lt;</span>x0)</span>
<span id="cb55-8"><a href="rng-nonuni.html#cb55-8" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="fu">sum</span>(idx)  <span class="co"># 累计符合要求样本数</span></span>
<span id="cb55-9"><a href="rng-nonuni.html#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j<span class="sc">&gt;=</span>n){</span>
<span id="cb55-10"><a href="rng-nonuni.html#cb55-10" aria-hidden="true" tabindex="-1"></a>     x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n] <span class="ot">&lt;-</span> y[idx][<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>i)]</span>
<span id="cb55-11"><a href="rng-nonuni.html#cb55-11" aria-hidden="true" tabindex="-1"></a>     <span class="cf">break</span>()</span>
<span id="cb55-12"><a href="rng-nonuni.html#cb55-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-13"><a href="rng-nonuni.html#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(j<span class="sc">==</span>i) <span class="cf">next</span>()</span>
<span id="cb55-14"><a href="rng-nonuni.html#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb55-15"><a href="rng-nonuni.html#cb55-15" aria-hidden="true" tabindex="-1"></a>      x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>j] <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb55-16"><a href="rng-nonuni.html#cb55-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb55-17"><a href="rng-nonuni.html#cb55-17" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> j</span>
<span id="cb55-18"><a href="rng-nonuni.html#cb55-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-19"><a href="rng-nonuni.html#cb55-19" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb55-20"><a href="rng-nonuni.html#cb55-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-21"><a href="rng-nonuni.html#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="rng-nonuni.html#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 随机模拟</span></span>
<span id="cb55-23"><a href="rng-nonuni.html#cb55-23" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb55-24"><a href="rng-nonuni.html#cb55-24" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.exp</span>(n)</span>
<span id="cb55-25"><a href="rng-nonuni.html#cb55-25" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span></code></pre></div>
<p>模拟得到的均值约为0.0249387。</p>
<p>下面进行理论推导。直接利用：
<span class="math display">\[
E(x)=\int_0^{0.05}xp(x)\mathrm dx = \frac{1-1.05e^{-0.05}}{1-e^{-0.05}}
\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="rng-nonuni.html#cb56-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="fl">-1.05</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.05</span>))</span></code></pre></div>
<p>利用计算机计算得到结果为0.0247917，相差1.4707064^{-4}。</p>
</div>
<div id="习题10" class="section level3 unnumbered">
<h3>习题10</h3>
<p><strong>解：</strong></p>
<p>方法1：逆变换法，仿照例6.2</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="rng-nonuni.html#cb57-1" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">10.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, lambda)</span>
<span id="cb57-2"><a href="rng-nonuni.html#cb57-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb57-3"><a href="rng-nonuni.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>m</span>
<span id="cb57-4"><a href="rng-nonuni.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda)<span class="sc">*</span>lambda<span class="sc">^</span>i<span class="sc">/</span><span class="fu">factorial</span>(i)</span>
<span id="cb57-5"><a href="rng-nonuni.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 排序</span></span>
<span id="cb57-6"><a href="rng-nonuni.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  ord <span class="ot">&lt;-</span> <span class="fu">order</span>(prob, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-7"><a href="rng-nonuni.html#cb57-7" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i[ord]</span>
<span id="cb57-8"><a href="rng-nonuni.html#cb57-8" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> prob[ord]</span>
<span id="cb57-9"><a href="rng-nonuni.html#cb57-9" aria-hidden="true" tabindex="-1"></a>  Fvs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(prob[<span class="dv">1</span><span class="sc">:</span>m]))</span>
<span id="cb57-10"><a href="rng-nonuni.html#cb57-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb57-11"><a href="rng-nonuni.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>,n)</span>
<span id="cb57-12"><a href="rng-nonuni.html#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb57-13"><a href="rng-nonuni.html#cb57-13" aria-hidden="true" tabindex="-1"></a>    x[j] <span class="ot">&lt;-</span> i[[<span class="fu">max</span>(<span class="fu">which</span>(Fvs <span class="sc">&lt;=</span> u[[j]]))]]</span>
<span id="cb57-14"><a href="rng-nonuni.html#cb57-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-15"><a href="rng-nonuni.html#cb57-15" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb57-16"><a href="rng-nonuni.html#cb57-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>方法2：注意到<span class="math inline">\(P\{X=k\}=e^{-\lambda}\frac{\lambda^k}{k!},k=0,1,\cdots\)</span>，则<span class="math inline">\(X\)</span>服从泊松分布。故可以生成服从泊松分布的随机数，若小于等于<span class="math inline">\(m\)</span>则保留，否则丢弃，仿照习题9：</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="rng-nonuni.html#cb58-1" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">10.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, lambda)</span>
<span id="cb58-2"><a href="rng-nonuni.html#cb58-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb58-3"><a href="rng-nonuni.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, n)</span>
<span id="cb58-4"><a href="rng-nonuni.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 记录符合要求的样本数</span></span>
<span id="cb58-5"><a href="rng-nonuni.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb58-6"><a href="rng-nonuni.html#cb58-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="fu">floor</span>(n<span class="sc">/</span><span class="fu">ppois</span>(m,lambda)),lambda)  <span class="co"># 分块生成样本，而不是单个生成</span></span>
<span id="cb58-7"><a href="rng-nonuni.html#cb58-7" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> (y<span class="sc">&lt;=</span>m)</span>
<span id="cb58-8"><a href="rng-nonuni.html#cb58-8" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="fu">sum</span>(idx)  <span class="co"># 累计符合要求样本数</span></span>
<span id="cb58-9"><a href="rng-nonuni.html#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(j<span class="sc">&gt;=</span>n){</span>
<span id="cb58-10"><a href="rng-nonuni.html#cb58-10" aria-hidden="true" tabindex="-1"></a>     x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n] <span class="ot">&lt;-</span> y[idx][<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>i)]</span>
<span id="cb58-11"><a href="rng-nonuni.html#cb58-11" aria-hidden="true" tabindex="-1"></a>     <span class="cf">break</span>()</span>
<span id="cb58-12"><a href="rng-nonuni.html#cb58-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-13"><a href="rng-nonuni.html#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(j<span class="sc">==</span>i) <span class="cf">next</span>()</span>
<span id="cb58-14"><a href="rng-nonuni.html#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb58-15"><a href="rng-nonuni.html#cb58-15" aria-hidden="true" tabindex="-1"></a>      x[(i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>j] <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb58-16"><a href="rng-nonuni.html#cb58-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-17"><a href="rng-nonuni.html#cb58-17" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> j</span>
<span id="cb58-18"><a href="rng-nonuni.html#cb58-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-19"><a href="rng-nonuni.html#cb58-19" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb58-20"><a href="rng-nonuni.html#cb58-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>测试：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="rng-nonuni.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb59-2"><a href="rng-nonuni.html#cb59-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-3"><a href="rng-nonuni.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb59-4"><a href="rng-nonuni.html#cb59-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb59-5"><a href="rng-nonuni.html#cb59-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb59-6"><a href="rng-nonuni.html#cb59-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb59-7"><a href="rng-nonuni.html#cb59-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.10.1</span>(n,m,lambda)</span>
<span id="cb59-8"><a href="rng-nonuni.html#cb59-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rng.10.2</span>(n,m,lambda)</span>
<span id="cb59-9"><a href="rng-nonuni.html#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">breaks =</span> m<span class="sc">+</span><span class="dv">1</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>))</span>
<span id="cb59-10"><a href="rng-nonuni.html#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">freq=</span><span class="cn">FALSE</span>,<span class="at">breaks =</span> m<span class="sc">+</span><span class="dv">1</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>))</span>
<span id="cb59-11"><a href="rng-nonuni.html#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>算是大致一致吧。</p>
</div>
<div id="习题11" class="section level3 unnumbered">
<h3>习题11</h3>
<p><strong>解：</strong></p>
<p>1、逆变换法：</p>
<p>利用条件概率公式，设二项分布的分布函数为<span class="math inline">\(F_1\)</span>：
<span class="math display">\[
F(y) = P\{Y\le y\}=\frac{P\{k\le X\le y\}}{P\{X\ge k\}}=\frac{F_1(y)-F_1(k-1)}{1-F_1(k-1)},\quad y=k,k+1,\cdots,n
\]</span></p>
<p>则当
<span class="math display">\[
\frac{F_1(i-1)-F_1(k-1)}{1-F_1(k-1)}&lt;u\le \frac{F_1(i)-F_1(k-1)}{1-F_1(k-1)},\quad i=k,k+1,\cdots,n
\]</span>
时取<span class="math inline">\(y=i\)</span>，上述条件又等价于
<span class="math display">\[
F_1(i-1)&lt;(1-F_1(k-1))u+F_1(k-1)\le F_1(i)
\]</span></p>
<p>定义函数</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="rng-nonuni.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># n:输出随机数长度</span></span>
<span id="cb60-2"><a href="rng-nonuni.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># size：实验次数</span></span>
<span id="cb60-3"><a href="rng-nonuni.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># k：题中参数</span></span>
<span id="cb60-4"><a href="rng-nonuni.html#cb60-4" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">11.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, size, <span class="at">k=</span><span class="dv">0</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb60-5"><a href="rng-nonuni.html#cb60-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb60-6"><a href="rng-nonuni.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>, n)</span>
<span id="cb60-7"><a href="rng-nonuni.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  ss <span class="ot">&lt;-</span> k<span class="sc">:</span>size <span class="co"># 样本空间</span></span>
<span id="cb60-8"><a href="rng-nonuni.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  Fvs <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(ss,size,prob)  <span class="co"># F_1值</span></span>
<span id="cb60-9"><a href="rng-nonuni.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb60-10"><a href="rng-nonuni.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> u<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span><span class="fu">pbinom</span>(k<span class="dv">-1</span>,size,prob)</span>
<span id="cb60-11"><a href="rng-nonuni.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb60-12"><a href="rng-nonuni.html#cb60-12" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(Fvs<span class="sc">&gt;=</span>u[[i]]))</span>
<span id="cb60-13"><a href="rng-nonuni.html#cb60-13" aria-hidden="true" tabindex="-1"></a>    x[[i]] <span class="ot">&lt;-</span> ss[[j]]</span>
<span id="cb60-14"><a href="rng-nonuni.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-15"><a href="rng-nonuni.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb60-16"><a href="rng-nonuni.html#cb60-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>2、舍选法</p>
<p>密度函数：
<span class="math display">\[
P\{Y=y\} = F(y)-F(y-1)=\frac{F_1(y)-F_1(y-1)}{1-F_1(k-1)}=\frac{P\{X=y\}}{1-F_1(k-1)},\quad y=k,k+1,\cdots,n
\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="rng-nonuni.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 这里的n表示试投次数</span></span>
<span id="cb61-2"><a href="rng-nonuni.html#cb61-2" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">11.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n, size, <span class="at">k=</span><span class="dv">0</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb61-3"><a href="rng-nonuni.html#cb61-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb61-4"><a href="rng-nonuni.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> k<span class="sc">:</span>size</span>
<span id="cb61-5"><a href="rng-nonuni.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  fvs <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y,size,prob)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(k<span class="dv">-1</span>,size,prob))</span>
<span id="cb61-6"><a href="rng-nonuni.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(y,n,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb61-7"><a href="rng-nonuni.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(k<span class="sc">==</span>size){</span>
<span id="cb61-8"><a href="rng-nonuni.html#cb61-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rep</span>(y, n)</span>
<span id="cb61-9"><a href="rng-nonuni.html#cb61-9" aria-hidden="true" tabindex="-1"></a>    fvs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb61-10"><a href="rng-nonuni.html#cb61-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-11"><a href="rng-nonuni.html#cb61-11" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="fu">min</span>(<span class="dv">1</span>,<span class="fu">max</span>(fvs)))</span>
<span id="cb61-12"><a href="rng-nonuni.html#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb61-13"><a href="rng-nonuni.html#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[[i]]<span class="sc">&gt;</span>fvs[[x[[i]]<span class="sc">-</span>k<span class="sc">+</span><span class="dv">1</span>]]) x[[i]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>  <span class="co"># 拒绝</span></span>
<span id="cb61-14"><a href="rng-nonuni.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-15"><a href="rng-nonuni.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  x[x<span class="sc">&gt;-</span><span class="dv">1</span>]</span>
<span id="cb61-16"><a href="rng-nonuni.html#cb61-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>3、理论分析</p>
<p>由于
<span class="math display">\[
P\{Y=y\} = F(y)-F(y-1)=\frac{F_1(y)-F_1(y-1)}{1-F_1(k-1)}=\frac{P\{X=y\}}{1-F_1(k-1)},\quad y=k,k+1,\cdots,n
\]</span></p>
<p>有：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="rng-nonuni.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb62-2"><a href="rng-nonuni.html#cb62-2" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb62-3"><a href="rng-nonuni.html#cb62-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb62-4"><a href="rng-nonuni.html#cb62-4" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb62-5"><a href="rng-nonuni.html#cb62-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> k<span class="sc">:</span>size</span>
<span id="cb62-6"><a href="rng-nonuni.html#cb62-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y,size,prob)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(k<span class="dv">-1</span>,size,prob))</span>
<span id="cb62-7"><a href="rng-nonuni.html#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="rng-nonuni.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 变换法</span></span>
<span id="cb62-9"><a href="rng-nonuni.html#cb62-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-10"><a href="rng-nonuni.html#cb62-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.11.1</span>(n,size,k,prob)</span>
<span id="cb62-11"><a href="rng-nonuni.html#cb62-11" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">table</span>(x)<span class="sc">/</span>n</span>
<span id="cb62-12"><a href="rng-nonuni.html#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="rng-nonuni.html#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 拒绝采样</span></span>
<span id="cb62-14"><a href="rng-nonuni.html#cb62-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb62-15"><a href="rng-nonuni.html#cb62-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.11.2</span>(n,size,k,prob)</span>
<span id="cb62-16"><a href="rng-nonuni.html#cb62-16" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">table</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb62-17"><a href="rng-nonuni.html#cb62-17" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">length</span>(x)<span class="sc">/</span>n</span>
<span id="cb62-18"><a href="rng-nonuni.html#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="rng-nonuni.html#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较结果</span></span>
<span id="cb62-20"><a href="rng-nonuni.html#cb62-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y,<span class="at">p=</span>p,<span class="at">m1=</span><span class="fu">as.double</span>(m1),<span class="at">m2=</span><span class="fu">as.double</span>(m2))</span>
<span id="cb62-21"><a href="rng-nonuni.html#cb62-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df,<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">p</th>
<th align="right">m1</th>
<th align="right">m2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.124</td>
<td align="right">0.123</td>
<td align="right">0.125</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.217</td>
<td align="right">0.208</td>
<td align="right">0.211</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.260</td>
<td align="right">0.264</td>
<td align="right">0.266</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.217</td>
<td align="right">0.220</td>
<td align="right">0.211</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.124</td>
<td align="right">0.126</td>
<td align="right">0.124</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.046</td>
<td align="right">0.048</td>
<td align="right">0.052</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.010</td>
<td align="right">0.010</td>
<td align="right">0.010</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.001</td>
<td align="right">0.001</td>
<td align="right">0.000</td>
</tr>
</tbody>
</table>
<p>基本上相差不大。</p>
<p>接下来考虑<span class="math inline">\(\alpha=P\{X\ge k\}\)</span>对拒绝采样接受率的影响，实验中取不同的<span class="math inline">\(k\)</span>用于表示不同的<span class="math inline">\(\alpha\)</span>。</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="rng-nonuni.html#cb63-1" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb63-2"><a href="rng-nonuni.html#cb63-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>size</span>
<span id="cb63-3"><a href="rng-nonuni.html#cb63-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb63-4"><a href="rng-nonuni.html#cb63-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20000</span>  <span class="co"># 试投点数</span></span>
<span id="cb63-5"><a href="rng-nonuni.html#cb63-5" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>,<span class="fu">length</span>(k))</span>
<span id="cb63-6"><a href="rng-nonuni.html#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="rng-nonuni.html#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="rng-nonuni.html#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(k)){</span>
<span id="cb63-9"><a href="rng-nonuni.html#cb63-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rng.11.2</span>(n,size,k[[i]],prob)</span>
<span id="cb63-10"><a href="rng-nonuni.html#cb63-10" aria-hidden="true" tabindex="-1"></a>  r[[i]] <span class="ot">&lt;-</span> <span class="fu">length</span>(x)<span class="sc">/</span>n  <span class="co"># 接受率</span></span>
<span id="cb63-11"><a href="rng-nonuni.html#cb63-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-12"><a href="rng-nonuni.html#cb63-12" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(k<span class="dv">-1</span>,size,prob)</span>
<span id="cb63-13"><a href="rng-nonuni.html#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(alpha,r,<span class="at">type=</span><span class="st">&quot;p&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-70-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>也不好说<span class="math inline">\(\alpha\)</span>取什么值时拒绝采样方法不可取，应该是比较小的时候。</p>
</div>
<div id="习题12" class="section level3 unnumbered">
<h3>习题12</h3>
<p><strong>解：</strong></p>
<p>方法1：拒绝采样</p>
<p>先观察一下密度函数：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="rng-nonuni.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x),<span class="dv">0</span>,<span class="dv">20</span>,<span class="at">ylab=</span><span class="st">&quot;p(x)&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-71-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>若使用均匀分布作提议分布，容易求得
<span class="math display">\[
\min p(x) = p(1) = 1/e
\]</span></p>
<p>采样：</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="rng-nonuni.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议分布为均匀分布</span></span>
<span id="cb65-2"><a href="rng-nonuni.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># px为密度函数,</span></span>
<span id="cb65-3"><a href="rng-nonuni.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n不是生成px的样本数，而是提议分布的样本数</span></span>
<span id="cb65-4"><a href="rng-nonuni.html#cb65-4" aria-hidden="true" tabindex="-1"></a>rejection_sampling_unit <span class="ot">&lt;-</span> <span class="cf">function</span>(px, n, c,...){</span>
<span id="cb65-5"><a href="rng-nonuni.html#cb65-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, ...)  <span class="co"># 生成n个随机数</span></span>
<span id="cb65-6"><a href="rng-nonuni.html#cb65-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span>  <span class="fu">px</span>(x)</span>
<span id="cb65-7"><a href="rng-nonuni.html#cb65-7" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span>  <span class="fu">runif</span>(n, <span class="dv">0</span>, c)</span>
<span id="cb65-8"><a href="rng-nonuni.html#cb65-8" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> (z<span class="sc">&lt;=</span>y)</span>
<span id="cb65-9"><a href="rng-nonuni.html#cb65-9" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">&lt;-</span>  <span class="fu">list</span>(<span class="at">data =</span> <span class="fu">tibble</span>(x,y,z,d),</span>
<span id="cb65-10"><a href="rng-nonuni.html#cb65-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">samples =</span> x[d])</span>
<span id="cb65-11"><a href="rng-nonuni.html#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb65-12"><a href="rng-nonuni.html#cb65-12" aria-hidden="true" tabindex="-1"></a>}    </span>
<span id="cb65-13"><a href="rng-nonuni.html#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="rng-nonuni.html#cb65-14" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb65-15"><a href="rng-nonuni.html#cb65-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x<span class="sc">&gt;</span><span class="dv">0</span>,x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x),<span class="dv">0</span>)</span>
<span id="cb65-16"><a href="rng-nonuni.html#cb65-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-17"><a href="rng-nonuni.html#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="rng-nonuni.html#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="rng-nonuni.html#cb65-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb65-20"><a href="rng-nonuni.html#cb65-20" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb65-21"><a href="rng-nonuni.html#cb65-21" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">rejection_sampling_unit</span>(px, n, c, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb65-22"><a href="rng-nonuni.html#cb65-22" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> out1<span class="sc">$</span>data</span>
<span id="cb65-23"><a href="rng-nonuni.html#cb65-23" aria-hidden="true" tabindex="-1"></a>tb1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb65-24"><a href="rng-nonuni.html#cb65-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> z, <span class="at">color =</span> d, <span class="at">shape=</span>d), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb65-25"><a href="rng-nonuni.html#cb65-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb65-26"><a href="rng-nonuni.html#cb65-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> c), <span class="at">linetype =</span> <span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb65-27"><a href="rng-nonuni.html#cb65-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;z&quot;</span>,<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">&quot;acceptance&quot;</span>,<span class="at">shape =</span> <span class="st">&quot;acceptance&quot;</span>)<span class="sc">+</span></span>
<span id="cb65-28"><a href="rng-nonuni.html#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb65-29"><a href="rng-nonuni.html#cb65-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;以均匀分布作提议分布的拒绝采样，接受率=&quot;</span>,<span class="fu">mean</span>(tb1<span class="sc">$</span>d),<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-72-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>接受率比较低，效率不高。</p>
<p>方法2：利用指数分布作提议分布。注意到<span class="math inline">\(X\sim\mathrm{Gamma}(2,1)\)</span>，<span class="math inline">\(EX=2\)</span>，使用期望为<span class="math inline">\(1\)</span>的指数分布<span class="math inline">\(g(x)=0.5e^{-0.5x}\)</span>作为提议分布。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="rng-nonuni.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议分布为均匀分布</span></span>
<span id="cb66-2"><a href="rng-nonuni.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># px为密度函数,</span></span>
<span id="cb66-3"><a href="rng-nonuni.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n不是生成px的样本数，而是提议分布的样本数</span></span>
<span id="cb66-4"><a href="rng-nonuni.html#cb66-4" aria-hidden="true" tabindex="-1"></a>rejection_sampling_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(px, n,...){</span>
<span id="cb66-5"><a href="rng-nonuni.html#cb66-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, ...)  <span class="co"># 生成n个随机数</span></span>
<span id="cb66-6"><a href="rng-nonuni.html#cb66-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">px</span>(x)</span>
<span id="cb66-7"><a href="rng-nonuni.html#cb66-7" aria-hidden="true" tabindex="-1"></a>    gx <span class="ot">&lt;-</span> <span class="fu">dexp</span>(x, ...)</span>
<span id="cb66-8"><a href="rng-nonuni.html#cb66-8" aria-hidden="true" tabindex="-1"></a>    ppx <span class="ot">&lt;-</span> <span class="fu">max</span>(y<span class="sc">/</span>gx)<span class="sc">*</span>gx  <span class="co"># 求c</span></span>
<span id="cb66-9"><a href="rng-nonuni.html#cb66-9" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, ppx)</span>
<span id="cb66-10"><a href="rng-nonuni.html#cb66-10" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> (z<span class="sc">&lt;=</span>y)</span>
<span id="cb66-11"><a href="rng-nonuni.html#cb66-11" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">&lt;-</span>  <span class="fu">list</span>(<span class="at">data =</span> <span class="fu">tibble</span>(x,y,z,d,ppx),</span>
<span id="cb66-12"><a href="rng-nonuni.html#cb66-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">samples =</span> x[d])</span>
<span id="cb66-13"><a href="rng-nonuni.html#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb66-14"><a href="rng-nonuni.html#cb66-14" aria-hidden="true" tabindex="-1"></a>}    </span>
<span id="cb66-15"><a href="rng-nonuni.html#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="rng-nonuni.html#cb66-16" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb66-17"><a href="rng-nonuni.html#cb66-17" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x<span class="sc">&gt;</span><span class="dv">0</span>,x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x),<span class="dv">0</span>)</span>
<span id="cb66-18"><a href="rng-nonuni.html#cb66-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-19"><a href="rng-nonuni.html#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="rng-nonuni.html#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="rng-nonuni.html#cb66-21" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb66-22"><a href="rng-nonuni.html#cb66-22" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">rejection_sampling_exp</span>(px, n, <span class="fl">0.5</span>)</span>
<span id="cb66-23"><a href="rng-nonuni.html#cb66-23" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> out1<span class="sc">$</span>data</span>
<span id="cb66-24"><a href="rng-nonuni.html#cb66-24" aria-hidden="true" tabindex="-1"></a>tb1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb66-25"><a href="rng-nonuni.html#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> z, <span class="at">color =</span> d, <span class="at">shape=</span>d), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-26"><a href="rng-nonuni.html#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb66-27"><a href="rng-nonuni.html#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ppx), <span class="at">linetype =</span> <span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb66-28"><a href="rng-nonuni.html#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;z&quot;</span>,<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">&quot;acceptance&quot;</span>,<span class="at">shape =</span> <span class="st">&quot;acceptance&quot;</span>)<span class="sc">+</span></span>
<span id="cb66-29"><a href="rng-nonuni.html#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb66-30"><a href="rng-nonuni.html#cb66-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;以指数分布作提议分布的拒绝采样，接受率=&quot;</span>,<span class="fu">mean</span>(tb1<span class="sc">$</span>d),<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-73-1.png" width="70%" style="display: block; margin: auto;" />
接受率提高了很多。</p>
</div>
<div id="习题13" class="section level3 unnumbered">
<h3>习题13</h3>
<p><strong>解：</strong></p>
<p>设
<span class="math display">\[
P\{Z=1\}=0.3,P\{Z=2\}=0.3,P\{Z=3\}=0.26,P\{Z=4\}=0.14
\]</span>
当<span class="math inline">\(Z=1\)</span>，X均匀取<span class="math inline">\(1,2,3,4,5\)</span>，当<span class="math inline">\(Z=2\)</span>，X均匀取<span class="math inline">\(6,9\)</span>，当<span class="math inline">\(Z=3\)</span>，X均匀取<span class="math inline">\(7,10\)</span>，当<span class="math inline">\(Z=4\)</span>，X均匀取<span class="math inline">\(8\)</span>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="rng-nonuni.html#cb67-1" aria-hidden="true" tabindex="-1"></a>rng<span class="fl">.13</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb67-2"><a href="rng-nonuni.html#cb67-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb67-3"><a href="rng-nonuni.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(<span class="dv">4</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.26</span>,<span class="fl">0.14</span>))</span>
<span id="cb67-4"><a href="rng-nonuni.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>,n)</span>
<span id="cb67-5"><a href="rng-nonuni.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  x[z<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">sum</span>(z<span class="sc">==</span><span class="dv">1</span>),<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-6"><a href="rng-nonuni.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  x[z<span class="sc">==</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">9</span>),<span class="fu">sum</span>(z<span class="sc">==</span><span class="dv">2</span>),<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-7"><a href="rng-nonuni.html#cb67-7" aria-hidden="true" tabindex="-1"></a>  x[z<span class="sc">==</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">10</span>),<span class="fu">sum</span>(z<span class="sc">==</span><span class="dv">3</span>),<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-8"><a href="rng-nonuni.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  x[z<span class="sc">==</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb67-9"><a href="rng-nonuni.html#cb67-9" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb67-10"><a href="rng-nonuni.html#cb67-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-11"><a href="rng-nonuni.html#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="rng-nonuni.html#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb67-13"><a href="rng-nonuni.html#cb67-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb67-14"><a href="rng-nonuni.html#cb67-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.13</span>(n)</span>
<span id="cb67-15"><a href="rng-nonuni.html#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(x)<span class="sc">/</span>n</span>
<span id="cb67-16"><a href="rng-nonuni.html#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x</span></span>
<span id="cb67-17"><a href="rng-nonuni.html#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1      2      3      4      5      6      7      8      9     10 </span></span>
<span id="cb67-18"><a href="rng-nonuni.html#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.0613 0.0590 0.0602 0.0585 0.0589 0.1507 0.1245 0.1407 0.1510 0.1352</span></span></code></pre></div>
<p>大致符合。</p>
</div>
<div id="习题14" class="section level3 unnumbered">
<h3>习题14</h3>
<p><strong>解：</strong></p>
<p>似乎有点问题。</p>
<p><span class="math display">\[
F(k)=P\{X\le k\}=\sum_{i=1}^kP\{X=i\}=\frac32-\frac{1}{2^{k+1}}-\frac{2^k}{3^k}\rightarrow \frac32\ne 1
\]</span></p>
</div>
<div id="习题15" class="section level3 unnumbered">
<h3>习题15</h3>
<p><strong>解：</strong></p>
<p>1、逆变换法：</p>
<p>先求分布函数：
<span class="math display">\[
F(x)=
\begin{cases}
\frac12 e^x &amp; x\le 0\\
1-\frac12 e^{-x} &amp; x&gt;0\\
\end{cases}
\]</span></p>
<p>求逆函数可以得到：
<span class="math display">\[
X=
\begin{cases}
\log(2u) &amp; u\le 0.5\\
-\log(2(1-u)) &amp; u&gt;0.5
\end{cases}
\]</span></p>
<p>采样函数：</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="rng-nonuni.html#cb68-1" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">15.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb68-2"><a href="rng-nonuni.html#cb68-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb68-3"><a href="rng-nonuni.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb68-4"><a href="rng-nonuni.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u<span class="sc">&lt;=</span><span class="fl">0.5</span>,<span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u),<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u))</span>
<span id="cb68-5"><a href="rng-nonuni.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb68-6"><a href="rng-nonuni.html#cb68-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-7"><a href="rng-nonuni.html#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="rng-nonuni.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb68-9"><a href="rng-nonuni.html#cb68-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb68-10"><a href="rng-nonuni.html#cb68-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.15.1</span>(n)</span>
<span id="cb68-11"><a href="rng-nonuni.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">100</span>,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb68-12"><a href="rng-nonuni.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)),<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>,<span class="at">to =</span><span class="dv">10</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-75-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>2、复合法</p>
<p>实际上类似于上面的逆变换法，设
<span class="math display">\[
P\{Z=0\}=P\{Z=1\}=0.5
\]</span></p>
<p>当<span class="math inline">\(Z=0\)</span>，取<span class="math inline">\(X=\log u\)</span>，当<span class="math inline">\(Z=1\)</span>，取<span class="math inline">\(X=-\log u\)</span>。</p>
<p>采样函数：</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="rng-nonuni.html#cb69-1" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">15.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb69-2"><a href="rng-nonuni.html#cb69-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb69-3"><a href="rng-nonuni.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb69-4"><a href="rng-nonuni.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb69-5"><a href="rng-nonuni.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">log</span>(u)</span>
<span id="cb69-6"><a href="rng-nonuni.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(z<span class="sc">&lt;=</span><span class="fl">0.5</span>,x,<span class="sc">-</span>x)</span>
<span id="cb69-7"><a href="rng-nonuni.html#cb69-7" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb69-8"><a href="rng-nonuni.html#cb69-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-9"><a href="rng-nonuni.html#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="rng-nonuni.html#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb69-11"><a href="rng-nonuni.html#cb69-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-12"><a href="rng-nonuni.html#cb69-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.15.2</span>(n)</span>
<span id="cb69-13"><a href="rng-nonuni.html#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">100</span>,<span class="at">freq =</span> <span class="cn">FALSE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb69-14"><a href="rng-nonuni.html#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)),<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>,<span class="at">to =</span><span class="dv">10</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-76-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="习题16" class="section level3 unnumbered">
<h3>习题16</h3>
<p><strong>解：</strong></p>
<p>比较容易想到的当然是拒绝采样。</p>
<p>先观察密度函数形状：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="rng-nonuni.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fl">0.000336</span>,<span class="fl">0.8</span>,<span class="dv">1</span>,<span class="at">ylab=</span><span class="st">&quot;p(x)&quot;</span>)</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-77-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>使用均匀分布作提议分布拒绝率应该会在0.5以下，不妨考虑一下<span class="math inline">\([0.8,1]\)</span>上的三角分布：
<span class="math display">\[
p(x) = 50-50x,\qquad 0.8&lt;x&lt;1
\]</span>
其分布函数的逆为：
<span class="math display">\[
F^{-1}(u) = 1-\frac{\sqrt{u}}{5}
\]</span></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="rng-nonuni.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议分布为三角分布</span></span>
<span id="cb71-2"><a href="rng-nonuni.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># px为密度函数,</span></span>
<span id="cb71-3"><a href="rng-nonuni.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n不是生成px的样本数，而是提议分布的样本数</span></span>
<span id="cb71-4"><a href="rng-nonuni.html#cb71-4" aria-hidden="true" tabindex="-1"></a>rejection_sampling_tri <span class="ot">&lt;-</span> <span class="cf">function</span>(px, n){</span>
<span id="cb71-5"><a href="rng-nonuni.html#cb71-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">runif</span>(n))<span class="sc">/</span><span class="dv">5</span>  <span class="co"># 生成n个随机数</span></span>
<span id="cb71-6"><a href="rng-nonuni.html#cb71-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span><span class="fu">px</span>(x)</span>
<span id="cb71-7"><a href="rng-nonuni.html#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 提议分布</span></span>
<span id="cb71-8"><a href="rng-nonuni.html#cb71-8" aria-hidden="true" tabindex="-1"></a>    ppx <span class="ot">&lt;-</span> (<span class="fu">px</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="fu">px</span>(<span class="fl">0.8</span>))<span class="sc">/</span><span class="fl">0.2</span><span class="sc">*</span>(x<span class="fl">-0.8</span>)<span class="sc">+</span><span class="fu">px</span>(<span class="fl">0.8</span>)</span>
<span id="cb71-9"><a href="rng-nonuni.html#cb71-9" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,ppx)</span>
<span id="cb71-10"><a href="rng-nonuni.html#cb71-10" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> (z<span class="sc">&lt;=</span>y)</span>
<span id="cb71-11"><a href="rng-nonuni.html#cb71-11" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">&lt;-</span>  <span class="fu">list</span>(<span class="at">data =</span> <span class="fu">tibble</span>(x,y,ppx,z,d),</span>
<span id="cb71-12"><a href="rng-nonuni.html#cb71-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">samples =</span> x[d])</span>
<span id="cb71-13"><a href="rng-nonuni.html#cb71-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb71-14"><a href="rng-nonuni.html#cb71-14" aria-hidden="true" tabindex="-1"></a>}    </span>
<span id="cb71-15"><a href="rng-nonuni.html#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="rng-nonuni.html#cb71-16" aria-hidden="true" tabindex="-1"></a>px <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb71-17"><a href="rng-nonuni.html#cb71-17" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fl">0.000336</span></span>
<span id="cb71-18"><a href="rng-nonuni.html#cb71-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-19"><a href="rng-nonuni.html#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="rng-nonuni.html#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="rng-nonuni.html#cb71-21" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb71-22"><a href="rng-nonuni.html#cb71-22" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">rejection_sampling_tri</span>(px, n)</span>
<span id="cb71-23"><a href="rng-nonuni.html#cb71-23" aria-hidden="true" tabindex="-1"></a>tb1 <span class="ot">&lt;-</span> out1<span class="sc">$</span>data</span>
<span id="cb71-24"><a href="rng-nonuni.html#cb71-24" aria-hidden="true" tabindex="-1"></a>tb1 <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb71-25"><a href="rng-nonuni.html#cb71-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> z, <span class="at">color =</span> d, <span class="at">shape=</span>d), <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb71-26"><a href="rng-nonuni.html#cb71-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb71-27"><a href="rng-nonuni.html#cb71-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ppx), <span class="at">linetype =</span> <span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb71-28"><a href="rng-nonuni.html#cb71-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;z&quot;</span>,<span class="at">y=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">&quot;acceptance&quot;</span>,<span class="at">shape =</span> <span class="st">&quot;acceptance&quot;</span>)<span class="sc">+</span></span>
<span id="cb71-29"><a href="rng-nonuni.html#cb71-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb71-30"><a href="rng-nonuni.html#cb71-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;以三角分布作提议分布的拒绝采样，接受率=&quot;</span>,<span class="fu">mean</span>(tb1<span class="sc">$</span>d),<span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-78-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>还有另一个方法是，注意到这是一个条件<span class="math inline">\(\mathrm{Beta}(2,4)\)</span>分布，即
<span class="math display">\[
p(x) = p(y|y&gt;0.8),\quad y\sim \mathrm{Beta}(2,4)
\]</span></p>
<p>所以另一个办法就是生成<span class="math inline">\(\mathrm{Beta}(2,4)\)</span>分布随机数，若大于<span class="math inline">\(0.8\)</span>就保留：</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="rng-nonuni.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># n：试投点数</span></span>
<span id="cb72-2"><a href="rng-nonuni.html#cb72-2" aria-hidden="true" tabindex="-1"></a>rng.<span class="fl">16.2</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb72-3"><a href="rng-nonuni.html#cb72-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb72-4"><a href="rng-nonuni.html#cb72-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb72-5"><a href="rng-nonuni.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  x[x<span class="sc">&gt;</span><span class="fl">0.8</span>]</span>
<span id="cb72-6"><a href="rng-nonuni.html#cb72-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-7"><a href="rng-nonuni.html#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="rng-nonuni.html#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb72-9"><a href="rng-nonuni.html#cb72-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb72-10"><a href="rng-nonuni.html#cb72-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rng.16.2</span>(n)</span>
<span id="cb72-11"><a href="rng-nonuni.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-12"><a href="rng-nonuni.html#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fl">0.000336</span>,<span class="fl">0.8</span>,<span class="dv">1</span>,<span class="at">add =</span> <span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb72-13"><a href="rng-nonuni.html#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)<span class="sc">/</span>n</span>
<span id="cb72-14"><a href="rng-nonuni.html#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.00635</span></span></code></pre></div>
<p><img src="statcomp_files/figure-html/unnamed-chunk-79-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>但是拒绝率太低了，惨不忍睹。</p>
</div>
<div id="习题17" class="section level3 unnumbered">
<h3>习题17</h3>
<p><strong>解：</strong></p>
<ol style="list-style-type: decimal">
<li>只证前半部分。</li>
</ol>
<p>把<span class="math inline">\(Y\)</span>看作<span class="math inline">\(X\)</span>的一个变换，<span class="math inline">\(Y=g(X)=a+(b-a)X\)</span>，<span class="math inline">\(X\)</span>有密度函数<span class="math inline">\(p_R(x)=2x,x\in(0,1)\)</span>，函数<span class="math inline">\(g(\cdot)\)</span>有反函数<span class="math inline">\(x=g^{-1}(y)=h(y)=(y-a)/(b-a)\)</span>，则<span class="math inline">\(Y\)</span>有密度函数：
<span class="math display">\[
p_Y(x) = p_R(h(y))\cdot|h&#39;(y)|=2\cdot\frac{y-a}{b-a}\cdot\frac1{b-a}=\frac{2(y-a)}{(b-a)^2},\quad y\in(a,b)
\]</span>
故<span class="math inline">\(Y\sim\mathrm{RT}(a,b)\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>类似地，令<span class="math inline">\(Y=g(X)=1-X\)</span>，<span class="math inline">\(h(y)=1-y\)</span>，则<span class="math inline">\(Y\)</span>有密度函数</li>
</ol>
<p><span class="math display">\[
p_Y(x) = p_R(h(y))\cdot|h&#39;(y)|=2(1-y)\cdot|-1|=2(1-y),\quad y\in(0,1)
\]</span>
故<span class="math inline">\(Y\sim\mathrm{LT}(0,1)\)</span>.</p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(X\)</span>的分布函数
<span class="math display">\[
F(x)=P\{X\le x\}=P\{U_1\le x,U_2\le x\}=P\{U_1\le x\}P\{U_2\le x\}=x^2,\quad x\in (0,1)
\]</span>
故<span class="math inline">\(X\sim\mathrm{RT}(0,1)\)</span>.</li>
</ol>
</div>
<div id="习题18" class="section level3 unnumbered">
<h3>习题18</h3>
<p><strong>解：</strong></p>
<p>只需要证明它是变形的Box-Muller变换即可。</p>
<p>由于<span class="math inline">\(\alpha\sim U(0,1)\)</span>，则<span class="math inline">\(\tilde\alpha=\alpha/2\pi\sim U(0,1)\)</span>.</p>
<p>由于<span class="math inline">\(R\sim\exp(1/2)\)</span>，则<span class="math inline">\(1-e^{-R/2}\sim U(0,1)\)</span>，即<span class="math inline">\(\tilde R=e^{-R/2}\sim U(0,1)\)</span>.</p>
<p>并且还有<span class="math inline">\(\alpha\perp\!\!\!\!\perp R\)</span>，所以<span class="math inline">\(\tilde\alpha\perp\!\!\!\!\perp \tilde R\)</span>，利用Box-Muller公式，有
<span class="math display">\[
\begin{cases}
X = \sqrt{-2\ln\tilde R}\cos\left(\frac{\alpha}{2\pi}\cdot 2\pi\right)\\
Y = \sqrt{-2\ln\tilde R}\sin\left(\frac{\alpha}{2\pi}\cdot 2\pi\right)
\end{cases}
\]</span>
相互独立且都服从标准正态分布。</p>
</div>
<div id="习题20" class="section level3 unnumbered">
<h3>习题20</h3>
<p><strong>解：</strong></p>
<p>容易知道，联合分布的密度函数为<span class="math inline">\(p(x,y)=1/\pi\)</span>。</p>
<p>（1）<span class="math inline">\(R^2\)</span>的分布函数：
<span class="math display">\[
F_1(r^2)=P\{R^2\le r^2\}=\int_{x^2+y^2\le r^2} p(x,y)\mathrm dx\mathrm dy=r^2
\]</span>
从而<span class="math inline">\(R^2\sim U(0,1)\)</span>。</p>
<p>（2）不妨用<span class="math inline">\(A(\theta,R^2)\)</span>表示圆<span class="math inline">\(x^2+y^2\le R^2\)</span>中弧度为<span class="math inline">\(\theta\)</span>的扇形区域，则<span class="math inline">\(\theta\)</span>的分布函数：
<span class="math display">\[
F_2(z)=P\{\theta\le z\}=\int_{A(z,1)} p(x,y)\mathrm dx\mathrm dy=\frac z{2\pi}
\]</span>
从而<span class="math inline">\(\theta\sim U(0,2\pi)\)</span>。</p>
<p>（3）<span class="math inline">\((R^2,\theta)\)</span>的联合分布函数：
<span class="math display">\[
F(r^2,z)=P\{R^2\le r^2,\theta\le z\}=\int_{A(z,r^2)} p(x,y)\mathrm dx\mathrm dy=r^2\cdot\frac{z}{2\pi}=F_1(r^2)\cdot F_2(z)
\]</span>
从而两者独立。</p>
</div>
<div id="习题21" class="section level3 unnumbered">
<h3>习题21</h3>
<p><strong>解：</strong></p>
<p>1、由于
<span class="math display">\[
F(x)=\frac{G(x)-G(a)}{G(b)-G(a)}=\frac{P\{a&lt;X\le x\}}{P\{a&lt;X\le b\}}=P\{X\le x|a&lt;X\le b\}
\]</span></p>
<p>2、这不是显然吗…（嚣张doge）。</p>
</div>
<div id="习题22" class="section level3 unnumbered">
<h3>习题22</h3>
<p><strong>解：</strong></p>
<p>1、<span class="math inline">\(p_1=\lambda_1\)</span>显然，不妨记<span class="math inline">\(S_n=\sum_{k=1}^np_k\)</span>，由于
<span class="math display">\[
1-\lambda_n=\frac{1-S_n}{1-S_{n-1}}
\]</span>
则
<span class="math display">\[
(1-\lambda_1)\cdots(1-\lambda_{n-1})\lambda_n=(1-p_1)\frac{1-S_2}{1-S_{1}}\cdot\frac{1-S_3}{1-S_{2}}\cdots\frac{1-S_{n-1}}{1-S_{n-2}}\frac{p_n}{1-S_{n-1}}=p_n
\]</span></p>
<p>2、由算法过程可以知道，取<span class="math inline">\(X=k\)</span>当且仅当前<span class="math inline">\(k-1\)</span>个<span class="math inline">\((0,1)\)</span>均匀随机数大于等于对应的<span class="math inline">\(\lambda_i\)</span>，并且第<span class="math inline">\(k\)</span>个<span class="math inline">\((0,1)\)</span>均匀随机数小于<span class="math inline">\(\lambda_k\)</span>。而第<span class="math inline">\(i\)</span>个<span class="math inline">\((0,1)\)</span>均匀随机数大于<span class="math inline">\(\lambda_i\)</span>的概率为<span class="math inline">\(p_i=1-\lambda_i\)</span>，从而取<span class="math inline">\(X=k\)</span>的概率为
<span class="math display">\[
p=p_1\cdot p_2\cdots p_{k-1}(1-p_k)=(1-\lambda_1)\cdots(1-\lambda_{k-1})\lambda_k=p_k
\]</span>
从而算法是合理的。</p>
<p>3、上述算法不就是生成<span class="math inline">\(X\)</span>分布的随机数吗…明显的有效性？大概是一个几何分布的“无记忆性”，<span class="math inline">\(\lambda_k\)</span>是一个常数，当生成随机数数量较大时也很有效，因为不需要计算所有的<span class="math inline">\(\lambda_k\)</span>。</p>
</div>
<div id="习题23" class="section level3 unnumbered">
<h3>习题23</h3>
<p><strong>解：</strong></p>
<p>1、几何分布，<span class="math inline">\(p=\lambda\)</span>。</p>
<p>2、…</p>

</div>
</div>
</div>
<section style="
    display: block;
">
<script src="https://utteranc.es/client.js"
        repo="huanghaicheng1024/statcomp"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</section>
            </section>

          </div>
        </div>
      </div>
<a href="rng-uniform.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rng-multi.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/huanghaicheng1024/statcomp/edit/main/rng-nonuni.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
